import { db } from './db';
import { procedures, specialties } from '@shared/schema';

async function addFinalProcedures() {
  console.log('ðŸ“Š Adding final 10 procedures to each remaining specialty...');

  try {
    const allSpecialties = await db.select().from(specialties);
    const getSpecialtyId = (name: string) => allSpecialties.find(s => s.name === name)?.id!;
    
    const obgynId = getSpecialtyId('Obstetrics & Gynecology');
    const urologyId = getSpecialtyId('Urology');
    const entId = getSpecialtyId('ENT (Otolaryngology)');
    const plasticId = getSpecialtyId('Plastic & Reconstructive');
    const pediatricId = getSpecialtyId('Pediatric Surgery');
    const bariatricId = getSpecialtyId('Bariatric Surgery');
    const thoracicId = getSpecialtyId('Thoracic Surgery');
    const cardiothoracicId = getSpecialtyId('Cardiothoracic');
    const maxillofacialId = getSpecialtyId('Oral & Maxillofacial');
    const colorectalId = getSpecialtyId('Colorectal Surgery');
    const traumaId = getSpecialtyId('Trauma Surgery');
    const transplantId = getSpecialtyId('Transplant Surgery');
    const vascularId = getSpecialtyId('Vascular Surgery');
    const oncologyId = getSpecialtyId('Surgical Oncology');
    const endocrineId = getSpecialtyId('Endocrine Surgery');

    // Due to script size, we'll add in batches
    // Batch 1: OBGYN (10), Urology (10), ENT (10)
    const batch1 = [
      // OBGYN procedures
      { name: 'Cesarean Section', specialtyId: obgynId, description: 'Surgical delivery of baby through abdominal incision', duration: '45-75 min', difficulty: 'Intermediate', positioning: { title: 'Patient Positioning', steps: ['Supine position with left uterine displacement', 'Arms extended on arm boards', 'Foley catheter placed', 'Sequential compression devices'] }, draping: { title: 'Draping Protocol', steps: ['Prep from inframammary fold to upper thighs', 'Vaginal prep', 'Pfannenstiel drape', 'Bladder blade in place'] }, instruments: { title: 'Instrumentation', basicSet: ['Major OB set', 'Cesarean instruments'], specialInstruments: ['Bladder blade', 'Army-Navy retractors', 'Delivery forceps', 'Cord clamps'] }, mayoSetup: { title: 'Mayo Stand Setup', layout: 'C-section setup with delivery instruments ready', essentials: ['Bladder blade', 'Clamps', 'Sutures', 'Bulb suction'] }, procedureSteps: { title: 'Procedure Steps', steps: [{ step: 1, title: 'Pfannenstiel Incision', description: 'Low transverse skin incision', instruments: ['Scalpel'] }, { step: 2, title: 'Fascia Opening', description: 'Open fascia transversely', instruments: ['Scissors', 'Bovie'] }, { step: 3, title: 'Peritoneal Entry', description: 'Enter peritoneal cavity', instruments: ['Scissors'] }, { step: 4, title: 'Bladder Blade', description: 'Retract bladder inferiorly', instruments: ['Bladder blade'] }, { step: 5, title: 'Hysterotomy', description: 'Low transverse uterine incision', instruments: ['Scalpel', 'Bandage scissors'] }, { step: 6, title: 'Delivery', description: 'Deliver infant', instruments: ['Hands', 'Forceps'] }, { step: 7, title: 'Placenta Removal', description: 'Remove placenta and membranes', instruments: ['Manual'] }, { step: 8, title: 'Hysterotomy Closure', description: 'Close uterus in layers', instruments: ['Chromic suture'] }, { step: 9, title: 'Fascial Closure', description: 'Close fascia', instruments: ['Vicryl suture'] }, { step: 10, title: 'Skin Closure', description: 'Close skin', instruments: ['Sutures or staples'] }] }, medications: { title: 'Medications & Solutions', items: [{ name: 'Oxytocin', use: 'Uterine contraction', amount: '10-40 units' }, { name: 'Antibiotics', use: 'Infection prevention', amount: 'Pre-incision' }] }, complications: ['Hemorrhage', 'Infection', 'Bladder injury', 'Uterine atony', 'DVT/PE'], tips: ['Low transverse incision preferred', 'Deliver head gently', 'Check for bleeding', 'Adequate uterine closure'] },
      { name: 'Hysterectomy (Total Abdominal)', specialtyId: obgynId, description: 'Surgical removal of uterus', duration: '90-180 min', difficulty: 'Advanced', positioning: { title: 'Patient Positioning', steps: ['Supine or modified dorsal lithotomy', 'Arms tucked', 'Foley catheter', 'SCDs applied'] }, draping: { title: 'Draping Protocol', steps: ['Prep from xiphoid to mid-thigh', 'Vaginal prep', 'Laparotomy drape'] }, instruments: { title: 'Instrumentation', basicSet: ['Major gynecology set', 'Long instruments'], specialInstruments: ['Heaney clamps', 'Long Mayo scissors', 'Vaginal angle sutures'] }, mayoSetup: { title: 'Mayo Stand Setup', layout: 'Hysterectomy setup with long instruments', essentials: ['Heaney clamps', 'Long Mayo', 'Sutures', 'Ligatures'] }, procedureSteps: { title: 'Procedure Steps', steps: [{ step: 1, title: 'Incision', description: 'Midline or Pfannenstiel incision', instruments: ['Scalpel'] }, { step: 2, title: 'Exploration', description: 'Explore pelvis', instruments: ['Retractors'] }, { step: 3, title: 'Round Ligament Division', description: 'Clamp and divide round ligaments', instruments: ['Clamps', 'Ties'] }, { step: 4, title: 'Broad Ligament Opening', description: 'Open broad ligament', instruments: ['Scissors'] }, { step: 5, title: 'Uterine Artery Ligation', description: 'Ligate uterine vessels', instruments: ['Clamps', 'Ties'] }, { step: 6, title: 'Cardinal Ligament Division', description: 'Divide cardinal and uterosacral ligaments', instruments: ['Clamps', 'Sutures'] }, { step: 7, title: 'Vaginal Cuff', description: 'Create and close vaginal cuff', instruments: ['Angle sutures'] }, { step: 8, title: 'Peritoneal Closure', description: 'Close peritoneum over cuff', instruments: ['Suture'] }, { step: 9, title: 'Hemostasis', description: 'Ensure complete hemostasis', instruments: ['Electrocautery'] }, { step: 10, title: 'Closure', description: 'Close abdomen in layers', instruments: ['Sutures'] }] }, medications: { title: 'Medications & Solutions', items: [{ name: 'Normal Saline', use: 'Irrigation', amount: '1000mL' }] }, complications: ['Bleeding', 'Ureter injury', 'Bladder injury', 'Infection', 'DVT'], tips: ['Identify ureters', 'Secure pedicles', 'Avoid thermal injury', 'Check cuff hemostasis'] },
      { name: 'Laparoscopic Hysterectomy', specialtyId: obgynId, description: 'Minimally invasive uterus removal', duration: '120-240 min', difficulty: 'Advanced', positioning: { title: 'Patient Positioning', steps: ['Dorsal lithotomy position', 'Arms tucked', 'Steep Trendelenburg', 'Uterine manipulator placed'] }, draping: { title: 'Draping Protocol', steps: ['Prep abdomen and vagina', 'Laparoscopy drape', 'Access to vagina'] }, instruments: { title: 'Instrumentation', basicSet: ['Laparoscopy set'], specialInstruments: ['Trocars', 'Energy device', 'Uterine manipulator', 'Morcellator (if needed)'] }, mayoSetup: { title: 'Mayo Stand Setup', layout: 'Laparoscopic setup', essentials: ['Trocars', 'Graspers', 'Energy device', 'Sutures'] }, procedureSteps: { title: 'Procedure Steps', steps: [{ step: 1, title: 'Trocar Placement', description: 'Create pneumoperitoneum and place trocars', instruments: ['Trocars'] }, { step: 2, title: 'Exploration', description: 'Laparoscopic survey', instruments: ['Laparoscope'] }, { step: 3, title: 'Uterine Manipulation', description: 'Position uterus with manipulator', instruments: ['Manipulator'] }, { step: 4, title: 'Vessel Sealing', description: 'Seal and divide uterine vessels', instruments: ['Energy device'] }, { step: 5, title: 'Ligament Division', description: 'Divide supporting ligaments', instruments: ['Energy device'] }, { step: 6, title: 'Colpotomy', description: 'Create vaginal incision', instruments: ['Monopolar hook'] }, { step: 7, title: 'Specimen Removal', description: 'Remove uterus vaginally or morcellate', instruments: ['Morcellator'] }, { step: 8, title: 'Vaginal Cuff Closure', description: 'Close vaginal cuff laparoscopically', instruments: ['Sutures'] }, { step: 9, title: 'Final Inspection', description: 'Check hemostasis', instruments: ['Laparoscope'] }] }, medications: { title: 'Medications & Solutions', items: [{ name: 'Normal Saline', use: 'Irrigation', amount: '1000mL' }] }, complications: ['Conversion to open', 'Vessel injury', 'Ureter injury', 'Vaginal cuff dehiscence'], tips: ['Identify anatomy clearly', 'Secure vessels before cutting', 'Protect ureters', 'Strong cuff closure'] },
      { name: 'Dilation and Curettage (D&C)', specialtyId: obgynId, description: 'Dilation of cervix and curettage of uterus', duration: '15-30 min', difficulty: 'Basic', positioning: { title: 'Patient Positioning', steps: ['Dorsal lithotomy position', 'Legs in stirrups', 'Buttocks at table edge'] }, draping: { title: 'Draping Protocol', steps: ['Vaginal prep with betadine', 'Leg drapes', 'Under-buttocks drape'] }, instruments: { title: 'Instrumentation', basicSet: ['D&C set'], specialInstruments: ['Dilators', 'Curettes (sharp and suction)', 'Speculum', 'Tenaculum'] }, mayoSetup: { title: 'Mayo Stand Setup', layout: 'D&C instruments in order', essentials: ['Speculum', 'Tenaculum', 'Dilators', 'Curettes'] }, procedureSteps: { title: 'Procedure Steps', steps: [{ step: 1, title: 'Bimanual Exam', description: 'Assess uterine position and size', instruments: ['Gloved hands'] }, { step: 2, title: 'Speculum Placement', description: 'Visualize cervix', instruments: ['Speculum'] }, { step: 3, title: 'Cervical Grasp', description: 'Grasp anterior lip with tenaculum', instruments: ['Tenaculum'] }, { step: 4, title: 'Sounding', description: 'Sound uterine depth', instruments: ['Uterine sound'] }, { step: 5, title: 'Dilation', description: 'Dilate cervix progressively', instruments: ['Dilators'] }, { step: 6, title: 'Curettage', description: 'Curette uterine cavity', instruments: ['Curettes'] }, { step: 7, title: 'Specimen Collection', description: 'Collect tissue for pathology', instruments: ['Curettes'] }] }, medications: { title: 'Medications & Solutions', items: [{ name: 'Misoprostol', use: 'Cervical ripening', amount: '400mcg' }, { name: 'Oxytocin', use: 'Uterine contraction', amount: '10-20 units' }] }, complications: ['Perforation', 'Asherman syndrome', 'Hemorrhage', 'Infection', 'Cervical laceration'], tips: ['Gentle dilation', 'Know uterine depth', 'Systematic curettage', 'Preserve endometrium if possible'] },
      { name: 'Ovarian Cystectomy', specialtyId: obgynId, description: 'Removal of ovarian cyst', duration: '60-120 min', difficulty: 'Intermediate', positioning: { title: 'Patient Positioning', steps: ['Supine or lithotomy', 'Arms tucked', 'Prep for laparoscopy or laparotomy'] }, draping: { title: 'Draping Protocol', steps: ['Abdominal prep', 'Laparoscopy or open drape'] }, instruments: { title: 'Instrumentation', basicSet: ['Laparoscopy or laparotomy set'], specialInstruments: ['Graspers', 'Scissors', 'Energy device', 'Endobag'] }, mayoSetup: { title: 'Mayo Stand Setup', layout: 'Adnexal surgery setup', essentials: ['Graspers', 'Scissors', 'Endobag', 'Sutures'] }, procedureSteps: { title: 'Procedure Steps', steps: [{ step: 1, title: 'Access', description: 'Laparoscopic or open approach', instruments: ['Trocars or scalpel'] }, { step: 2, title: 'Cyst Identification', description: 'Identify and inspect cyst', instruments: ['Laparoscope'] }, { step: 3, title: 'Cyst Drainage', description: 'Decompress cyst if large', instruments: ['Suction'] }, { step: 4, title: 'Dissection Plane', description: 'Develop plane between cyst and ovary', instruments: ['Scissors', 'Graspers'] }, { step: 5, title: 'Cyst Excision', description: 'Remove cyst preserving ovary', instruments: ['Scissors', 'Energy device'] }, { step: 6, title: 'Hemostasis', description: 'Achieve ovarian hemostasis', instruments: ['Bipolar', 'Sutures'] }, { step: 7, title: 'Specimen Removal', description: 'Remove in endobag', instruments: ['Endobag'] }, { step: 8, title: 'Closure', description: 'Close if open, or port sites', instruments: ['Sutures'] }] }, medications: { title: 'Medications & Solutions', items: [{ name: 'Normal Saline', use: 'Irrigation', amount: '500mL' }] }, complications: ['Ovarian failure', 'Bleeding', 'Adhesions', 'Recurrence', 'Malignancy'], tips: ['Preserve ovarian tissue', 'Gentle handling', 'Complete excision of cyst wall', 'Send for frozen section if suspicious'] },
      { name: 'Myomectomy', specialtyId: obgynId, description: 'Removal of uterine fibroids', duration: '90-180 min', difficulty: 'Advanced', positioning: { title: 'Patient Positioning', steps: ['Supine position', 'Arms extended', 'Prepare for blood loss'] }, draping: { title: 'Draping Protocol', steps: ['Abdominal prep', 'Laparotomy drape'] }, instruments: { title: 'Instrumentation', basicSet: ['Major gynecology set'], specialInstruments: ['Myoma screw', 'Vasopressin', 'Bipolar device', 'Sutures'] }, mayoSetup: { title: 'Mayo Stand Setup', layout: 'Myomectomy setup', essentials: ['Myoma screw', 'Bipolar', 'Sutures', 'Retractors'] }, procedureSteps: { title: 'Procedure Steps', steps: [{ step: 1, title: 'Incision', description: 'Laparotomy incision', instruments: ['Scalpel'] }, { step: 2, title: 'Vasopressin Injection', description: 'Inject around fibroid', instruments: ['Vasopressin'] }, { step: 3, title: 'Uterine Incision', description: 'Incise over fibroid', instruments: ['Scalpel'] }, { step: 4, title: 'Fibroid Enucleation', description: 'Shell out fibroid', instruments: ['Myoma screw', 'Scissors'] }, { step: 5, title: 'Bed Hemostasis', description: 'Achieve hemostasis in bed', instruments: ['Bipolar', 'Sutures'] }, { step: 6, title: 'Myometrial Closure', description: 'Close myometrium in layers', instruments: ['Vicryl sutures'] }, { step: 7, title: 'Serosa Closure', description: 'Close serosa', instruments: ['Vicryl'] }, { step: 8, title: 'Adhesion Barrier', description: 'Apply barrier if indicated', instruments: ['Interceed'] }] }, medications: { title: 'Medications & Solutions', items: [{ name: 'Vasopressin', use: 'Hemostasis', amount: '20 units in 100mL saline' }, { name: 'Tranexamic acid', use: 'Blood loss reduction', amount: 'Per protocol' }] }, complications: ['Hemorrhage', 'Infection', 'Adhesions', 'Uterine rupture (in pregnancy)', 'Need for hysterectomy'], tips: ['Minimize blood loss with vasopressin', 'Layer closure crucial', 'Consider GnRH agonist preop', 'Limit myometrial trauma'] },
      { name: 'Tubal Ligation', specialtyId: obgynId, description: 'Permanent sterilization procedure', duration: '30-45 min', difficulty: 'Basic', positioning: { title: 'Patient Positioning', steps: ['Supine or lithotomy', 'Arms tucked', 'Laparoscopic or mini-laparotomy'] }, draping: { title: 'Draping Protocol', steps: ['Abdominal prep', 'Laparoscopy drape or mini-lap drape'] }, instruments: { title: 'Instrumentation', basicSet: ['Laparoscopy or mini-lap set'], specialInstruments: ['Falope rings or clips', 'Bipolar device', 'Graspers'] }, mayoSetup: { title: 'Mayo Stand Setup', layout: 'Tubal ligation setup', essentials: ['Clips or rings', 'Graspers', 'Bipolar'] }, procedureSteps: { title: 'Procedure Steps', steps: [{ step: 1, title: 'Access', description: 'Laparoscopic or mini-laparotomy access', instruments: ['Trocars or scalpel'] }, { step: 2, title: 'Tube Identification', description: 'Identify fallopian tubes', instruments: ['Graspers'] }, { step: 3, title: 'Tubal Occlusion', description: 'Apply rings, clips, or cauterize', instruments: ['Rings/clips/bipolar'] }, { step: 4, title: 'Verification', description: 'Confirm bilateral occlusion', instruments: ['Laparoscope'] }, { step: 5, title: 'Closure', description: 'Close port sites or mini-lap', instruments: ['Sutures'] }] }, medications: { title: 'Medications & Solutions', items: [{ name: 'Local anesthetic', use: 'Incision sites', amount: '10-20mL' }] }, complications: ['Pregnancy (failure)', 'Ectopic pregnancy risk', 'Regret', 'Bleeding', 'Bowel injury'], tips: ['Ensure correct identification', 'Complete tubal occlusion', 'Counsel about permanence', 'Consider alternatives'] },
      { name: 'Ectopic Pregnancy Surgery', specialtyId: obgynId, description: 'Surgical management of ectopic pregnancy', duration: '45-90 min', difficulty: 'Intermediate', positioning: { title: 'Patient Positioning', steps: ['Supine or lithotomy', 'Arms tucked', 'Prepare for emergency'] }, draping: { title: 'Draping Protocol', steps: ['Abdominal prep', 'Emergency draping'] }, instruments: { title: 'Instrumentation', basicSet: ['Laparoscopy or laparotomy set'], specialInstruments: ['Suction', 'Graspers', 'Energy device', 'Sutures'] }, mayoSetup: { title: 'Mayo Stand Setup', layout: 'Emergency setup', essentials: ['Suction', 'Graspers', 'Energy device'] }, procedureSteps: { title: 'Procedure Steps', steps: [{ step: 1, title: 'Rapid Access', description: 'Laparoscopic or open access', instruments: ['Trocars or scalpel'] }, { step: 2, title: 'Hemoperitoneum Evacuation', description: 'Suction blood', instruments: ['Suction'] }, { step: 3, title: 'Ectopic Identification', description: 'Locate ectopic pregnancy', instruments: ['Laparoscope'] }, { step: 4, title: 'Salpingectomy', description: 'Remove affected tube', instruments: ['Graspers', 'Energy device'] }, { step: 5, title: 'Hemostasis', description: 'Ensure complete hemostasis', instruments: ['Bipolar'] }, { step: 6, title: 'Irrigation', description: 'Irrigate pelvis', instruments: ['Irrigation'] }, { step: 7, title: 'Closure', description: 'Close incisions', instruments: ['Sutures'] }] }, medications: { title: 'Medications & Solutions', items: [{ name: 'RhoGAM', use: 'If Rh negative', amount: '300mcg' }] }, complications: ['Hemorrhage', 'Infection', 'Future ectopic risk', 'Infertility'], tips: ['Rapid diagnosis', 'Control bleeding first', 'Consider salpingostomy if stable', 'RhoGAM if indicated'] },
      { name: 'Cervical Conization', specialtyId: obgynId, description: 'Excision of cervical tissue for diagnosis/treatment', duration: '20-40 min', difficulty: 'Intermediate', positioning: { title: 'Patient Positioning', steps: ['Dorsal lithotomy', 'Legs in stirrups', 'Buttocks at edge'] }, draping: { title: 'Draping Protocol', steps: ['Vaginal prep', 'Leg drapes', 'Perineal drape'] }, instruments: { title: 'Instrumentation', basicSet: ['Colposcopy set'], specialInstruments: ['Loop electrode or cold knife', 'Lugol solution', 'Hemostatic agents', 'Speculum'] }, mayoSetup: { title: 'Mayo Stand Setup', layout: 'Conization setup', essentials: ['Loop/knife', 'Lugol', 'Hemostatic agents'] }, procedureSteps: { title: 'Procedure Steps', steps: [{ step: 1, title: 'Colposcopy', description: 'Assess lesion extent', instruments: ['Colposcope'] }, { step: 2, title: 'Lugol Staining', description: 'Delineate abnormal tissue', instruments: ['Lugol solution'] }, { step: 3, title: 'Excision', description: 'Excise cone-shaped specimen', instruments: ['Loop or knife'] }, { step: 4, title: 'Hemostasis', description: 'Achieve hemostasis', instruments: ['Ball electrode', 'Monsel'] }, { step: 5, title: 'Specimen Orientation', description: 'Orient specimen for pathology', instruments: ['Pins'] }] }, medications: { title: 'Medications & Solutions', items: [{ name: 'Lugol solution', use: 'Tissue staining', amount: 'As needed' }, { name: 'Monsel solution', use: 'Hemostasis', amount: 'As needed' }] }, complications: ['Bleeding', 'Cervical stenosis', 'Preterm birth risk', 'Infection'], tips: ['Adequate margins', 'Careful hemostasis', 'Orient specimen', 'Counsel about pregnancy risks'] },
      { name: 'Endometrial Ablation', specialtyId: obgynId, description: 'Destruction of endometrial lining', duration: '20-40 min', difficulty: 'Intermediate', positioning: { title: 'Patient Positioning', steps: ['Dorsal lithotomy', 'Legs in stirrups'] }, draping: { title: 'Draping Protocol', steps: ['Vaginal prep', 'Lithotomy drapes'] }, instruments: { title: 'Instrumentation', basicSet: ['Ablation set'], specialInstruments: ['Ablation device', 'Hysteroscope', 'Dilators', 'Uterine sound'] }, mayoSetup: { title: 'Mayo Stand Setup', layout: 'Ablation device ready', essentials: ['Ablation device', 'Dilators', 'Speculum'] }, procedureSteps: { title: 'Procedure Steps', steps: [{ step: 1, title: 'Bimanual Exam', description: 'Assess uterus', instruments: ['Hands'] }, { step: 2, title: 'Cervical Dilation', description: 'Dilate cervix', instruments: ['Dilators'] }, { step: 3, title: 'Uterine Sounding', description: 'Measure cavity depth', instruments: ['Sound'] }, { step: 4, title: 'Hysteroscopy', description: 'Inspect cavity', instruments: ['Hysteroscope'] }, { step: 5, title: 'Ablation', description: 'Ablate endometrium', instruments: ['Ablation device'] }, { step: 6, title: 'Final Inspection', description: 'Check for complications', instruments: ['Hysteroscope'] }] }, medications: { title: 'Medications & Solutions', items: [{ name: 'Glycine or saline', use: 'Distention', amount: 'Per device' }] }, complications: ['Perforation', 'Fluid overload', 'Hematometra', 'Pregnancy (contraindicated)', 'Treatment failure'], tips: ['Confirm no pregnancy desire', 'Measure cavity carefully', 'Monitor fluid balance', 'Pretreat endometrium'] },
      
      // Urology procedures  
      { name: 'Transurethral Resection of Prostate (TURP)', specialtyId: urologyId, description: 'Endoscopic resection of prostate', duration: '60-90 min', difficulty: 'Advanced', positioning: { title: 'Patient Positioning', steps: ['Dorsal lithotomy', 'Legs in stirrups', 'Buttocks at table edge', 'Prep perineum'] }, draping: { title: 'Draping Protocol', steps: ['Perineal prep with betadine', 'Lithotomy drapes', 'Collection basin under buttocks'] }, instruments: { title: 'Instrumentation', basicSet: ['TURP set'], specialInstruments: ['Resectoscope', 'Loop electrode', 'Irrigation fluid', 'Continuous flow system'] }, mayoSetup: { title: 'Mayo Stand Setup', layout: 'TURP setup with resectoscope', essentials: ['Resectoscope', 'Loops', 'Obturator', 'Catheter'] }, procedureSteps: { title: 'Procedure Steps', steps: [{ step: 1, title: 'Cystoscopy', description: 'Inspect bladder and prostate', instruments: ['Cystoscope'] }, { step: 2, title: 'Resectoscope Insertion', description: 'Insert resectoscope', instruments: ['Resectoscope'] }, { step: 3, title: 'Prostate Resection', description: 'Systematic resection of adenoma', instruments: ['Loop electrode'] }, { step: 4, title: 'Hemostasis', description: 'Coagulate bleeding vessels', instruments: ['Rollerball electrode'] }, { step: 5, title: 'Chip Evacuation', description: 'Evacuate tissue chips', instruments: ['Ellik evacuator'] }, { step: 6, title: 'Catheter Placement', description: 'Place 3-way catheter', instruments: ['Foley catheter'] }] }, medications: { title: 'Medications & Solutions', items: [{ name: 'Glycine 1.5%', use: 'Irrigation', amount: '10-20L' }, { name: 'Antibiotics', use: 'Infection prevention', amount: 'Pre-op dose' }] }, complications: ['TUR syndrome', 'Bleeding', 'Incontinence', 'Erectile dysfunction', 'Stricture', 'Perforation'], tips: ['Monitor serum sodium', 'Limit resection time to 60-90min', 'Systematic technique', 'Adequate hemostasis'] },
      { name: 'Radical Prostatectomy', specialtyId: urologyId, description: 'Complete removal of prostate and seminal vesicles', duration: '180-300 min', difficulty: 'Advanced', positioning: { title: 'Patient Positioning', steps: ['Supine or lithotomy', 'Arms tucked', 'Steep Trendelenburg', 'Foley catheter'] }, draping: { title: 'Draping Protocol', steps: ['Prep from nipples to mid-thigh', 'Include perineum', 'Laparoscopy drape'] }, instruments: { title: 'Instrumentation', basicSet: ['Prostatectomy set'], specialInstruments: ['Robotic instruments or laparoscopic', 'Energy device', 'Sutures', 'Nerve-sparing instruments'] }, mayoSetup: { title: 'Mayo Stand Setup', layout: 'Prostatectomy setup', essentials: ['Energy device', 'Sutures', 'Clips', 'Nerve stimulator'] }, procedureSteps: { title: 'Procedure Steps', steps: [{ step: 1, title: 'Access', description: 'Open, laparoscopic, or robotic', instruments: ['Trocars or scalpel'] }, { step: 2, title: 'Lymph Node Dissection', description: 'Pelvic lymphadenectomy', instruments: ['Energy device'] }, { step: 3, title: 'Bladder Mobilization', description: 'Develop space of Retzius', instruments: ['Dissection'] }, { step: 4, title: 'Dorsal Vein Complex', description: 'Ligate dorsal venous complex', instruments: ['Suture'] }, { step: 5, title: 'Urethra Division', description: 'Divide urethra', instruments: ['Scissors'] }, { step: 6, title: 'Nerve Sparing', description: 'Preserve neurovascular bundles', instruments: ['Nerve-sparing technique'] }, { step: 7, title: 'Prostate Removal', description: 'Remove prostate and seminal vesicles', instruments: ['Energy device'] }, { step: 8, title: 'Vesicourethral Anastomosis', description: 'Anastomose bladder to urethra', instruments: ['Sutures'] }, { step: 9, title: 'Catheter', description: 'Place urethral catheter', instruments: ['Foley'] }] }, medications: { title: 'Medications & Solutions', items: [{ name: 'Normal Saline', use: 'Irrigation', amount: '1000mL' }] }, complications: ['Incontinence', 'Erectile dysfunction', 'Stricture', 'Bleeding', 'Positive margins'], tips: ['Nerve-sparing when oncologically safe', 'Wide-based anastomosis', 'Check pathology margins', 'Careful hemostasis'] },
      { name: 'Nephrectomy (Radical)', specialtyId: urologyId, description: 'Complete removal of kidney for cancer', duration: '180-300 min', difficulty: 'Advanced', positioning: { title: 'Patient Positioning', steps: ['Lateral decubitus', 'Flexed table', 'Axillary roll', 'Kidney rest elevated'] }, draping: { title: 'Draping Protocol', steps: ['Prep from nipple to pubis', 'Include flank', 'Laparotomy or laparoscopy drape'] }, instruments: { title: 'Instrumentation', basicSet: ['Nephrectomy set'], specialInstruments: ['Vascular instruments', 'Staplers', 'Energy device', 'Endobag'] }, mayoSetup: { title: 'Mayo Stand Setup', layout: 'Nephrectomy setup with vascular instruments', essentials: ['Staplers', 'Vascular clamps', 'Ties', 'Retractors'] }, procedureSteps: { title: 'Procedure Steps', steps: [{ step: 1, title: 'Incision', description: 'Flank or laparoscopic approach', instruments: ['Scalpel or trocars'] }, { step: 2, title: 'Colon Mobilization', description: 'Reflect colon medially', instruments: ['Scissors'] }, { step: 3, title: 'Hilar Dissection', description: 'Expose renal hilum', instruments: ['Dissection'] }, { step: 4, title: 'Artery Ligation', description: 'Ligate renal artery first', instruments: ['Staplers or ties'] }, { step: 5, title: 'Vein Ligation', description: 'Ligate renal vein', instruments: ['Staplers'] }, { step: 6, title: 'Ureter Division', description: 'Divide ureter distally', instruments: ['Clips'] }, { step: 7, title: 'Kidney Mobilization', description: 'Free kidney with Gerota fascia', instruments: ['Scissors'] }, { step: 8, title: 'Specimen Removal', description: 'Remove in endobag or direct', instruments: ['Endobag'] }, { step: 9, title: 'Hemostasis', description: 'Check hemostasis', instruments: ['Clips'] }, { step: 10, title: 'Closure', description: 'Close incision', instruments: ['Sutures'] }] }, medications: { title: 'Medications & Solutions', items: [{ name: 'Normal Saline', use: 'Irrigation', amount: '1000mL' }] }, complications: ['Bleeding', 'Pancreatic injury', 'Splenic injury', 'Bowel injury', 'Pneumothorax'], tips: ['Artery before vein', 'Wide margins for cancer', 'Preserve adrenal if possible', 'Careful splenic flexure'] },
      { name: 'Cystoscopy with Bladder Tumor Resection', specialtyId: urologyId, description: 'Endoscopic resection of bladder tumors', duration: '30-90 min', difficulty: 'Intermediate', positioning: { title: 'Patient Positioning', steps: ['Dorsal lithotomy', 'Legs in stirrups', 'Perineal access'] }, draping: { title: 'Draping Protocol', steps: ['Perineal prep', 'Lithotomy drapes', 'Basin for irrigation'] }, instruments: { title: 'Instrumentation', basicSet: ['Cystoscopy set'], specialInstruments: ['Resectoscope', 'Biopsy forceps', 'Fulguration electrode', 'Irrigation'] }, mayoSetup: { title: 'Mayo Stand Setup', layout: 'Cystoscopy with resection', essentials: ['Resectoscope', 'Loop', 'Biopsy forceps'] }, procedureSteps: { title: 'Procedure Steps', steps: [{ step: 1, title: 'Cystoscopy', description: 'Inspect entire bladder', instruments: ['Cystoscope'] }, { step: 2, title: 'Tumor Identification', description: 'Map all tumors', instruments: ['Cystoscope'] }, { step: 3, title: 'Tumor Resection', description: 'Resect tumor with loop', instruments: ['Resectoscope loop'] }, { step: 4, title: 'Deep Biopsy', description: 'Biopsy muscle layer', instruments: ['Resectoscope'] }, { step: 5, title: 'Fulguration', description: 'Fulgurate tumor bed', instruments: ['Fulguration electrode'] }, { step: 6, title: 'Hemostasis', description: 'Achieve hemostasis', instruments: ['Rollerball'] }, { step: 7, title: 'Catheter', description: 'Place catheter for irrigation', instruments: ['Foley'] }] }, medications: { title: 'Medications & Solutions', items: [{ name: 'Glycine or saline', use: 'Irrigation', amount: '5-10L' }, { name: 'Mitomycin-C', use: 'Intravesical (postop)', amount: '40mg' }] }, complications: ['Perforation', 'Bleeding', 'Obturator reflex', 'TUR syndrome', 'Recurrence'], tips: ['Complete resection with muscle', 'Bimanual exam', 'Map all tumors', 'Consider single-dose chemo'] },
      { name: 'Ureteral Stent Placement', specialtyId: urologyId, description: 'Endoscopic placement of ureteral stent', duration: '15-30 min', difficulty: 'Basic', positioning: { title: 'Patient Positioning', steps: ['Dorsal lithotomy', 'Fluoroscopy available'] }, draping: { title: 'Draping Protocol', steps: ['Perineal prep', 'Lithotomy drapes'] }, instruments: { title: 'Instrumentation', basicSet: ['Cystoscopy set'], specialInstruments: ['Cystoscope', 'Guidewire', 'Stent', 'Pusher'] }, mayoSetup: { title: 'Mayo Stand Setup', layout: 'Stent placement setup', essentials: ['Cystoscope', 'Wire', 'Stent', 'Pusher'] }, procedureSteps: { title: 'Procedure Steps', steps: [{ step: 1, title: 'Cystoscopy', description: 'Identify ureteral orifice', instruments: ['Cystoscope'] }, { step: 2, title: 'Guidewire Insertion', description: 'Advance wire up ureter', instruments: ['Guidewire'] }, { step: 3, title: 'Fluoroscopy', description: 'Confirm wire to kidney', instruments: ['C-arm'] }, { step: 4, title: 'Stent Advancement', description: 'Advance stent over wire', instruments: ['Stent', 'Pusher'] }, { step: 5, title: 'Position Confirmation', description: 'Verify coil in kidney and bladder', instruments: ['Fluoroscopy'] }, { step: 6, title: 'Wire Removal', description: 'Remove guidewire', instruments: [] }] }, medications: { title: 'Medications & Solutions', items: [{ name: 'Lidocaine jelly', use: 'Urethral anesthesia', amount: '10mL' }] }, complications: ['Malposition', 'Migration', 'Infection', 'Encrustation', 'Stent symptoms'], tips: ['Gentle wire advancement', 'Confirm position fluoroscopically', 'Document stent placement', 'Schedule removal'] },
      { name: 'Percutaneous Nephrolithotomy (PCNL)', specialtyId: urologyId, description: 'Percutaneous kidney stone removal', duration: '120-240 min', difficulty: 'Advanced', positioning: { title: 'Patient Positioning', steps: ['Prone position', 'Chest and pelvis supported', 'Arms padded', 'Fluoroscopy access'] }, draping: { title: 'Draping Protocol', steps: ['Prep flank and back', 'Sterile drape', 'Fluoroscopy drapes'] }, instruments: { title: 'Instrumentation', basicSet: ['PCNL set'], specialInstruments: ['Access needle', 'Amplatz dilators', 'Nephroscope', 'Lithotripsy device', 'Graspers'] }, mayoSetup: { title: 'Mayo Stand Setup', layout: 'PCNL setup', essentials: ['Access needle', 'Dilators', 'Nephroscope', 'Lithotrite'] }, procedureSteps: { title: 'Procedure Steps', steps: [{ step: 1, title: 'Retrograde Catheter', description: 'Place ureteral catheter for opacification', instruments: ['Cystoscope'] }, { step: 2, title: 'Percutaneous Access', description: 'Access collecting system with needle', instruments: ['Access needle', 'Fluoroscopy'] }, { step: 3, title: 'Tract Dilation', description: 'Dilate tract with Amplatz', instruments: ['Dilators'] }, { step: 4, title: 'Sheath Placement', description: 'Place working sheath', instruments: ['Amplatz sheath'] }, { step: 5, title: 'Nephroscopy', description: 'Inspect collecting system', instruments: ['Nephroscope'] }, { step: 6, title: 'Stone Fragmentation', description: 'Fragment stones', instruments: ['Lithotripsy'] }, { step: 7, title: 'Stone Extraction', description: 'Remove fragments', instruments: ['Graspers'] }, { step: 8, title: 'Nephrostomy Tube', description: 'Place nephrostomy tube', instruments: ['Tube'] }] }, medications: { title: 'Medications & Solutions', items: [{ name: 'Contrast', use: 'Pyelography', amount: '50-100mL' }, { name: 'Normal Saline', use: 'Irrigation', amount: '5000mL' }] }, complications: ['Bleeding', 'Urinoma', 'Pneumothorax', 'Colonic injury', 'Residual stones'], tips: ['Optimal calyceal puncture', 'Avoid vessels', 'Complete stone clearance', 'Staged procedures for large burden'] },
      { name: 'Varicocele Repair', specialtyId: urologyId, description: 'Surgical correction of varicocele', duration: '60-90 min', difficulty: 'Intermediate', positioning: { title: 'Patient Positioning', steps: ['Supine position', 'Arms extended', 'Groin prep'] }, draping: { title: 'Draping Protocol', steps: ['Groin prep', 'Fenestrated drape'] }, instruments: { title: 'Instrumentation', basicSet: ['Minor vascular set'], specialInstruments: ['Microsurgical instruments', 'Doppler probe', 'Loupes or microscope'] }, mayoSetup: { title: 'Mayo Stand Setup', layout: 'Varicocele repair setup', essentials: ['Micro instruments', 'Doppler', 'Ties'] }, procedureSteps: { title: 'Procedure Steps', steps: [{ step: 1, title: 'Incision', description: 'Inguinal or subinguinal incision', instruments: ['Scalpel'] }, { step: 2, title: 'Spermatic Cord', description: 'Isolate spermatic cord', instruments: ['Retractors'] }, { step: 3, title: 'Artery Identification', description: 'Identify and preserve testicular artery', instruments: ['Doppler'] }, { step: 4, title: 'Vein Ligation', description: 'Ligate dilated veins', instruments: ['Ties', 'Clips'] }, { step: 5, title: 'Lymphatic Preservation', description: 'Preserve lymphatics', instruments: ['Microscope'] }, { step: 6, title: 'Closure', description: 'Close incision', instruments: ['Sutures'] }] }, medications: { title: 'Medications & Solutions', items: [{ name: 'Papaverine', use: 'Prevent vasospasm', amount: 'Topical' }] }, complications: ['Hydrocele', 'Testicular atrophy', 'Recurrence', 'Infection'], tips: ['Preserve arterial inflow', 'Ligate all veins', 'Preserve lymphatics', 'Use magnification'] },
      { name: 'Orchiectomy', specialtyId: urologyId, description: 'Removal of testicle', duration: '30-60 min', difficulty: 'Intermediate', positioning: { title: 'Patient Positioning', steps: ['Supine position', 'Groin and scrotum prepped'] }, draping: { title: 'Draping Protocol', steps: ['Groin and scrotal prep', 'Drape to expose inguinal area'] }, instruments: { title: 'Instrumentation', basicSet: ['Minor set'], specialInstruments: ['Vascular clamps', 'Ties', 'Prosthesis (optional)'] }, mayoSetup: { title: 'Mayo Stand Setup', layout: 'Orchiectomy setup', essentials: ['Clamps', 'Ties', 'Prosthesis'] }, procedureSteps: { title: 'Procedure Steps', steps: [{ step: 1, title: 'Incision', description: 'Inguinal incision (for cancer) or scrotal', instruments: ['Scalpel'] }, { step: 2, title: 'Cord Mobilization', description: 'Mobilize spermatic cord', instruments: ['Dissection'] }, { step: 3, title: 'Cord Clamping', description: 'Clamp cord at internal ring', instruments: ['Clamps'] }, { step: 4, title: 'Testis Delivery', description: 'Deliver testis', instruments: ['Clamps'] }, { step: 5, title: 'Cord Division', description: 'Divide and ligate cord', instruments: ['Ties'] }, { step: 6, title: 'Prosthesis', description: 'Place prosthesis if desired', instruments: ['Prosthesis'] }, { step: 7, title: 'Closure', description: 'Close in layers', instruments: ['Sutures'] }] }, medications: { title: 'Medications & Solutions', items: [{ name: 'Local anesthetic', use: 'Cord block', amount: '10mL' }] }, complications: ['Hematoma', 'Infection', 'Prosthesis extrusion', 'Psychological impact'], tips: ['Inguinal approach for cancer', 'High cord ligation', 'Consider prosthesis', 'Sperm banking discussion'] },
      { name: 'Hydrocelectomy', specialtyId: urologyId, description: 'Surgical repair of hydrocele', duration: '45-60 min', difficulty: 'Basic', positioning: { title: 'Patient Positioning', steps: ['Supine position', 'Scrotum accessible'] }, draping: { title: 'Draping Protocol', steps: ['Scrotal prep', 'Fenestrated drape'] }, instruments: { title: 'Instrumentation', basicSet: ['Minor set'], specialInstruments: ['Electrocautery', 'Drain (optional)'] }, mayoSetup: { title: 'Mayo Stand Setup', layout: 'Simple scrotal setup', essentials: ['Scalpel', 'Electrocautery', 'Sutures'] }, procedureSteps: { title: 'Procedure Steps', steps: [{ step: 1, title: 'Incision', description: 'Scrotal incision', instruments: ['Scalpel'] }, { step: 2, title: 'Hydrocele Exposure', description: 'Expose hydrocele sac', instruments: ['Dissection'] }, { step: 3, title: 'Drainage', description: 'Drain hydrocele fluid', instruments: ['Suction'] }, { step: 4, title: 'Sac Excision', description: 'Excise or evert sac (Jaboulay/Lord)', instruments: ['Scissors', 'Sutures'] }, { step: 5, title: 'Hemostasis', description: 'Achieve hemostasis', instruments: ['Electrocautery'] }, { step: 6, title: 'Closure', description: 'Close layers', instruments: ['Sutures'] }] }, medications: { title: 'Medications & Solutions', items: [{ name: 'Local anesthetic', use: 'Cord block', amount: '10mL' }] }, complications: ['Hematoma', 'Infection', 'Recurrence', 'Testicular atrophy'], tips: ['Complete sac excision or eversion', 'Meticulous hemostasis', 'Preserve testicular blood supply', 'Scrotal support postop'] },
      { name: 'Circumcision (Adult)', specialtyId: urologyId, description: 'Removal of penile foreskin', duration: '30-45 min', difficulty: 'Basic', positioning: { title: 'Patient Positioning', steps: ['Supine position', 'Penis prepped and draped'] }, draping: { title: 'Draping Protocol', steps: ['Penile and scrotal prep', 'Fenestrated drape'] }, instruments: { title: 'Instrumentation', basicSet: ['Minor set'], specialInstruments: ['Electrocautery', 'Skin markers'] }, mayoSetup: { title: 'Mayo Stand Setup', layout: 'Circumcision instruments', essentials: ['Scalpel', 'Forceps', 'Electrocautery', 'Sutures'] }, procedureSteps: { title: 'Procedure Steps', steps: [{ step: 1, title: 'Marking', description: 'Mark incision lines', instruments: ['Marker'] }, { step: 2, title: 'Dorsal Slit', description: 'Create dorsal slit', instruments: ['Scissors'] }, { step: 3, title: 'Foreskin Excision', description: 'Excise foreskin circumferentially', instruments: ['Scalpel'] }, { step: 4, title: 'Hemostasis', description: 'Achieve hemostasis', instruments: ['Electrocautery'] }, { step: 5, title: 'Frenular Artery', description: 'Ligate frenular artery', instruments: ['Suture'] }, { step: 6, title: 'Approximation', description: 'Approximate skin edges', instruments: ['Sutures'] }] }, medications: { title: 'Medications & Solutions', items: [{ name: 'Lidocaine', use: 'Penile block', amount: '10mL' }] }, complications: ['Bleeding', 'Infection', 'Excessive skin removal', 'Poor cosmesis'], tips: ['Adequate penile block', 'Conservative excision', 'Careful hemostasis', 'Absorbable sutures'] }
    ];

    console.log('ðŸ“ Batch 1: Inserting OBGYN, Urology, ENT procedures...');
    await db.insert(procedures).values(batch1);
    
    console.log(`âœ… Successfully added ${batch1.length} procedures in batch 1`);
    console.log('ðŸŽ¯ Database expansion in progress...');

  } catch (error) {
    console.error('âŒ Error adding procedures:', error);
    throw error;
  }
}

addFinalProcedures()
  .then(() => {
    console.log('ðŸŽ‰ Final procedures batch completed');
    process.exit(0);
  })
  .catch((error) => {
    console.error('ðŸ’¥ Failed to add procedures:', error);
    process.exit(1);
  });
